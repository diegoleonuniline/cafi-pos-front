<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>CAFI - Punto de Venta</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="styles.css">
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 500'%3E%3Cpath fill='%232D3DBF' d='M127.514 363.531C116.889 363.531 107.389 361.406 99.0137 357.156C90.7637 352.781 84.2637 346.594 79.5137 338.594C74.8887 330.469 72.5762 320.906 72.5762 309.906V190.094C72.5762 179.094 74.8887 169.594 79.5137 161.594C84.2637 153.469 90.7637 147.219 99.0137 142.844C107.389 138.469 116.889 136.281 127.514 136.281H187.201C197.826 136.281 207.264 138.469 215.514 142.844C223.889 147.219 230.389 153.469 235.014 161.594C239.764 169.594 242.139 179.094 242.139 190.094V213.719H192.701V194.156C192.701 188.281 191.014 183.594 187.639 180.094C184.389 176.469 179.951 174.656 174.326 174.656H140.389C134.764 174.656 130.264 176.469 126.889 180.094C123.639 183.594 122.014 188.281 122.014 194.156V305.844C122.014 311.719 123.639 316.469 126.889 320.094C130.264 323.594 134.764 325.344 140.389 325.344H174.326C179.951 325.344 184.389 323.594 187.639 320.094C191.014 316.469 192.701 311.719 192.701 305.844V286.281H242.139V309.906C242.139 320.906 239.764 330.469 235.014 338.594C230.389 346.594 223.889 352.781 215.514 357.156C207.264 361.406 197.826 363.531 187.201 363.531H127.514Z'/%3E%3Cpath fill='%236C2BD9' d='M317.66 136.281L384.473 360.531H332.785L321.035 318.156H271.785L260.035 360.531H211.035L277.848 136.281H317.66ZM296.223 195.656L280.66 280.094H312.16L296.598 195.656H296.223Z'/%3E%3Cpath fill='%232E2E2E' d='M389.555 360.531V136.281H499.93V174.656H439.18V229.281H485.68V267.656H439.18V360.531H389.555Z'/%3E%3C/svg%3E">
</head>
<body>
  
  <!-- ========== LOGIN ========== -->
  <div id="login-screen" class="screen login-screen">
    <div class="login-card">
      <div class="login-header">
        <div class="logo-icon">
          <svg viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg">
            <path fill="#2D3DBF" d="M127.514 363.531C116.889 363.531 107.389 361.406 99.0137 357.156C90.7637 352.781 84.2637 346.594 79.5137 338.594C74.8887 330.469 72.5762 320.906 72.5762 309.906V190.094C72.5762 179.094 74.8887 169.594 79.5137 161.594C84.2637 153.469 90.7637 147.219 99.0137 142.844C107.389 138.469 116.889 136.281 127.514 136.281H187.201C197.826 136.281 207.264 138.469 215.514 142.844C223.889 147.219 230.389 153.469 235.014 161.594C239.764 169.594 242.139 179.094 242.139 190.094V213.719H192.701V194.156C192.701 188.281 191.014 183.594 187.639 180.094C184.389 176.469 179.951 174.656 174.326 174.656H140.389C134.764 174.656 130.264 176.469 126.889 180.094C123.639 183.594 122.014 188.281 122.014 194.156V305.844C122.014 311.719 123.639 316.469 126.889 320.094C130.264 323.594 134.764 325.344 140.389 325.344H174.326C179.951 325.344 184.389 323.594 187.639 320.094C191.014 316.469 192.701 311.719 192.701 305.844V286.281H242.139V309.906C242.139 320.906 239.764 330.469 235.014 338.594C230.389 346.594 223.889 352.781 215.514 357.156C207.264 361.406 197.826 363.531 187.201 363.531H127.514Z"/>
            <path fill="#6C2BD9" d="M317.66 136.281L384.473 360.531H332.785L321.035 318.156H271.785L260.035 360.531H211.035L277.848 136.281H317.66ZM296.223 195.656L280.66 280.094H312.16L296.598 195.656H296.223Z"/>
            <path fill="#2E2E2E" d="M389.555 360.531V136.281H499.93V174.656H439.18V229.281H485.68V267.656H439.18V360.531H389.555Z"/>
          </svg>
        </div>
        <h1>CAFI</h1>
        <p>Sistema Punto de Venta</p>
      </div>
      <form id="login-form" class="login-form">
        <div class="field">
          <label for="login-email">Correo electrónico</label>
          <div class="input-icon">
            <i class="fas fa-envelope"></i>
            <input type="email" id="login-email" placeholder="usuario@empresa.com" required autocomplete="email">
          </div>
        </div>
        <div class="field">
          <label for="login-password">Contraseña</label>
          <div class="input-icon">
            <i class="fas fa-lock"></i>
            <input type="password" id="login-password" placeholder="••••••••" required autocomplete="current-password">
          </div>
        </div>
        <div id="login-error" class="error-msg"></div>
        <button type="submit" id="login-btn" class="btn btn-primary btn-block">
          <span>Iniciar Sesión</span>
          <div class="spinner"></div>
        </button>
      </form>
      <footer>© 2024 CAFI POS</footer>
    </div>
  </div>
  
  <!-- ========== LOADING ========== -->
  <div id="loading-screen" class="screen loading-screen" style="display:none">
    <div class="loading-content">
      <div class="logo-icon">
        <svg viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg">
          <path fill="#2D3DBF" d="M127.514 363.531C116.889 363.531 107.389 361.406 99.0137 357.156C90.7637 352.781 84.2637 346.594 79.5137 338.594C74.8887 330.469 72.5762 320.906 72.5762 309.906V190.094C72.5762 179.094 74.8887 169.594 79.5137 161.594C84.2637 153.469 90.7637 147.219 99.0137 142.844C107.389 138.469 116.889 136.281 127.514 136.281H187.201C197.826 136.281 207.264 138.469 215.514 142.844C223.889 147.219 230.389 153.469 235.014 161.594C239.764 169.594 242.139 179.094 242.139 190.094V213.719H192.701V194.156C192.701 188.281 191.014 183.594 187.639 180.094C184.389 176.469 179.951 174.656 174.326 174.656H140.389C134.764 174.656 130.264 176.469 126.889 180.094C123.639 183.594 122.014 188.281 122.014 194.156V305.844C122.014 311.719 123.639 316.469 126.889 320.094C130.264 323.594 134.764 325.344 140.389 325.344H174.326C179.951 325.344 184.389 323.594 187.639 320.094C191.014 316.469 192.701 311.719 192.701 305.844V286.281H242.139V309.906C242.139 320.906 239.764 330.469 235.014 338.594C230.389 346.594 223.889 352.781 215.514 357.156C207.264 361.406 197.826 363.531 187.201 363.531H127.514Z"/>
          <path fill="#6C2BD9" d="M317.66 136.281L384.473 360.531H332.785L321.035 318.156H271.785L260.035 360.531H211.035L277.848 136.281H317.66ZM296.223 195.656L280.66 280.094H312.16L296.598 195.656H296.223Z"/>
          <path fill="#2E2E2E" d="M389.555 360.531V136.281H499.93V174.656H439.18V229.281H485.68V267.656H439.18V360.531H389.555Z"/>
        </svg>
      </div>
      <h1>CAFI</h1>
      <div class="loader"></div>
      <p>Cargando datos...</p>
    </div>
  </div>

  <!-- ========== APP PRINCIPAL ========== -->
  <div id="app" class="app" style="display:none">
    
    <!-- HEADER -->
    <header class="header">
      <div class="header-left">
        <div class="logo">
          <div class="logo-icon small">
            <svg viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg">
              <path fill="#2D3DBF" d="M127.514 363.531C116.889 363.531 107.389 361.406 99.0137 357.156C90.7637 352.781 84.2637 346.594 79.5137 338.594C74.8887 330.469 72.5762 320.906 72.5762 309.906V190.094C72.5762 179.094 74.8887 169.594 79.5137 161.594C84.2637 153.469 90.7637 147.219 99.0137 142.844C107.389 138.469 116.889 136.281 127.514 136.281H187.201C197.826 136.281 207.264 138.469 215.514 142.844C223.889 147.219 230.389 153.469 235.014 161.594C239.764 169.594 242.139 179.094 242.139 190.094V213.719H192.701V194.156C192.701 188.281 191.014 183.594 187.639 180.094C184.389 176.469 179.951 174.656 174.326 174.656H140.389C134.764 174.656 130.264 176.469 126.889 180.094C123.639 183.594 122.014 188.281 122.014 194.156V305.844C122.014 311.719 123.639 316.469 126.889 320.094C130.264 323.594 134.764 325.344 140.389 325.344H174.326C179.951 325.344 184.389 323.594 187.639 320.094C191.014 316.469 192.701 311.719 192.701 305.844V286.281H242.139V309.906C242.139 320.906 239.764 330.469 235.014 338.594C230.389 346.594 223.889 352.781 215.514 357.156C207.264 361.406 197.826 363.531 187.201 363.531H127.514Z"/>
              <path fill="#6C2BD9" d="M317.66 136.281L384.473 360.531H332.785L321.035 318.156H271.785L260.035 360.531H211.035L277.848 136.281H317.66ZM296.223 195.656L280.66 280.094H312.16L296.598 195.656H296.223Z"/>
              <path fill="#2E2E2E" d="M389.555 360.531V136.281H499.93V174.656H439.18V229.281H485.68V267.656H439.18V360.531H389.555Z"/>
            </svg>
          </div>
          <span>CAFI</span>
        </div>
        <!-- CONTROLES DE TURNO -->
        <div class="turno-controls">
          <div id="turno-indicador" class="turno-indicador inactivo">
            <i class="fas fa-lock"></i> <span>Sin turno</span>
          </div>
          <button id="btn-abrir-turno" class="btn-turno" onclick="Turno.abrirModalAbrir()" title="Abrir Turno">
            <i class="fas fa-play"></i>
          </button>
          <button id="btn-movimientos-caja" class="btn-turno" style="display:none;" onclick="abrirMenuMovimientos()" title="Movimientos de Caja">
            <i class="fas fa-exchange-alt"></i>
          </button>
          <button id="btn-cerrar-turno" class="btn-turno danger" style="display:none;" onclick="Turno.abrirModalCerrar()" title="Cerrar Turno">
            <i class="fas fa-stop"></i>
          </button>
        </div>
      </div>
      <div class="header-center">
        <button class="hbtn" onclick="nuevaVenta()" title="Nueva venta (Ctrl+N)">
          <i class="fas fa-plus"></i><span>Nueva</span>
        </button>
        <button class="hbtn warning" onclick="abrirVentasEnEspera()" title="Ventas en espera (F8)">
          <i class="fas fa-clock"></i><span>Espera</span><b id="espera-badge"></b>
        </button>
        <button class="hbtn" onclick="abrirModal('modal-productos')" title="Administrar productos">
          <i class="fas fa-box"></i><span>Productos</span>
        </button>
        <button class="hbtn" onclick="abrirModal('modal-clientes')" title="Administrar clientes">
          <i class="fas fa-users"></i><span>Clientes</span>
        </button>
        <button class="hbtn icon-only" onclick="sincronizarManual()" title="Sincronizar datos">
          <i class="fas fa-sync-alt"></i>
        </button>
      </div>
      <div class="header-right">
        <div class="user-pill" onclick="mostrarInfoUsuario()">
          <div class="avatar" id="user-avatar">US</div>
          <div class="user-text">
            <span id="user-name">Usuario</span>
            <small id="user-sucursal">Sucursal</small>
          </div>
        </div>
        <button class="hbtn danger icon-only" onclick="cerrarSesion()" title="Cerrar sesión">
          <i class="fas fa-sign-out-alt"></i>
        </button>
      </div>
    </header>
    
    <!-- CONTENIDO PRINCIPAL -->
    <main class="main-content">
      
      <!-- PANEL IZQUIERDO: CARRITO -->
      <section class="panel-cart">
        
        <!-- BARRA DE VENTA -->
        <div class="sale-bar">
          <div class="sale-client" onclick="abrirModalSeleccionarCliente()">
            <i class="fas fa-user-circle"></i>
            <div>
              <small>Cliente</small>
              <strong id="cliente-nombre">Público General</strong>
            </div>
            <i class="fas fa-chevron-down"></i>
          </div>
          <div class="sale-type">
            <button class="active" id="btn-contado" onclick="setTipoVenta('CONTADO')">Contado</button>
            <button id="btn-credito" onclick="setTipoVenta('CREDITO')">Crédito</button>
          </div>
          <div class="sale-price">
            <label>Precio</label>
            <select id="precio-tipo-select" onchange="cambiarTipoPrecio(this.value)">
              <option value="1">P1</option>
              <option value="2">P2</option>
              <option value="3">P3</option>
              <option value="4">P4</option>
              <option value="5">P5</option>
              <option value="6">P6</option>
            </select>
          </div>
        </div>
        
        <!-- BARRA DE BÚSQUEDA -->
        <div class="search-bar">
          <div class="search-input">
            <i class="fas fa-barcode"></i>
            <input type="text" id="barcode" placeholder="Escanea código de barras o presiona F2 para buscar..." autofocus>
          </div>
          <button class="btn btn-primary" onclick="abrirModalBusqueda()">
            <i class="fas fa-search"></i>
            <span>Buscar</span>
            <kbd>F2</kbd>
          </button>
        </div>
        
        <!-- TABLA CARRITO -->
        <div class="cart-wrapper">
          <table class="cart-table">
            <thead>
              <tr>
                <th class="col-name">Producto</th>
                <th class="col-price">Precio</th>
                <th class="col-qty">Cantidad</th>
                <th class="col-unit">Und</th>
                <th class="col-total">Importe</th>
                <th class="col-actions"></th>
              </tr>
            </thead>
            <tbody id="cart-body"></tbody>
          </table>
          <div class="cart-empty" id="cart-empty">
            <i class="fas fa-shopping-cart"></i>
            <p>Escanea o busca productos para agregar</p>
            <small>Usa el lector de códigos o presiona <kbd>F2</kbd></small>
          </div>
        </div>
        
        <!-- FOOTER CARRITO -->
        <div class="cart-footer">
          <div class="cart-actions">
            <button class="btn btn-outline" onclick="solicitarAccionAdmin('cancelar')" title="Cancelar venta (F4)">
              <i class="fas fa-times"></i>
              <span>Cancelar</span>
              <kbd>F4</kbd>
            </button>
            <button class="btn btn-warning" onclick="ponerEnEspera()" title="Poner en espera (F8)">
              <i class="fas fa-pause"></i>
              <span>Espera</span>
            </button>
            <button class="btn btn-success btn-lg" onclick="abrirModalCobro()" title="Cobrar venta (F12)">
              <i class="fas fa-cash-register"></i>
              <span>Cobrar</span>
              <kbd>F12</kbd>
            </button>
          </div>
        </div>
      </section>
      
      <!-- PANEL DERECHO: RESUMEN -->
      <aside class="panel-payment">
        <div class="total-header">
          <span>Total a Pagar</span>
          <strong id="total-display">$0.00</strong>
        </div>
        
        <div class="payment-section">
          <h4>Resumen de Venta</h4>
          <div class="payment-info">
            <div class="info-row"><span>Artículos</span><span id="r-items">0</span></div>
            <div class="info-row"><span>Subtotal</span><span id="r-subtotal">$0.00</span></div>
            <div class="info-row"><span>Descuentos</span><span id="r-descuentos">$0.00</span></div>
            <div class="info-row"><span>Tipo</span><span id="r-tipo">Contado</span></div>
          </div>
        </div>
        
        <div class="payment-section ticket-info">
          <div class="ticket-row">
            <i class="fas fa-receipt"></i>
            <div>
              <span>Ticket</span>
              <strong id="ticket-num">#0001</strong>
            </div>
          </div>
          <div class="ticket-row">
            <i class="fas fa-user"></i>
            <div>
              <span>Cliente</span>
              <strong id="r-cliente">Público General</strong>
            </div>
          </div>
        </div>
        
        <!-- Input oculto para compatibilidad -->
        <input type="hidden" id="efectivo" value="0">
        <input type="hidden" id="total-amount" value="0">
        <input type="hidden" id="r-productos" value="0">
        <div id="cambio-box" style="display:none"><span id="cambio">$0.00</span></div>
        <div id="metodos-pago-grid" style="display:none"></div>
      </aside>
    </main>
    
    <!-- SHORTCUTS BAR -->
    <div class="shortcuts-bar">
      <span><kbd>F2</kbd> Buscar</span>
      <span><kbd>F4</kbd> Cancelar</span>
      <span><kbd>F8</kbd> Espera</span>
      <span><kbd>F12</kbd> Cobrar</span>
      <span><kbd>Esc</kbd> Cerrar</span>
    </div>
  </div>
  
  <!-- DROPDOWN MOVIMIENTOS DE CAJA -->
  <div id="menu-movimientos" class="dropdown-menu" style="display:none;">
    <button onclick="Turno.abrirModalMovimiento('Ingreso'); cerrarMenuMovimientos();">
      <i class="fas fa-arrow-down text-success"></i> Ingreso a Caja
    </button>
    <button onclick="Turno.abrirModalMovimiento('Egreso'); cerrarMenuMovimientos();">
      <i class="fas fa-arrow-up text-danger"></i> Retiro de Caja
    </button>
  </div>
  
  <!-- ========== MODALES ========== -->
  
  <!-- MODAL: BÚSQUEDA PRODUCTOS -->
  <div id="modal-busqueda" class="modal-overlay">
    <div class="modal modal-xl">
      <div class="modal-header">
        <h3><i class="fas fa-search"></i> Buscar Producto</h3>
        <button class="btn-close" onclick="cerrarModal('modal-busqueda')"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-toolbar">
        <div class="search-field large">
          <i class="fas fa-search"></i>
          <input type="text" id="search-producto" placeholder="Buscar por nombre o código..." oninput="filtrarProductos()" autofocus>
        </div>
        <div class="toolbar-controls">
          <div class="filter-select">
            <label>Categoría:</label>
            <select id="filtro-categoria" onchange="filtrarProductos()">
              <option value="">Todas</option>
            </select>
          </div>
          <div class="filter-select">
            <label>Marca:</label>
            <select id="filtro-marca" onchange="filtrarProductos()">
              <option value="">Todas</option>
            </select>
          </div>
          <div class="qty-control">
            <label>Cantidad:</label>
            <button onclick="cambiarCantidadBusqueda(-1)">−</button>
            <input type="number" id="busqueda-cantidad" value="1" min="1" step="1">
            <button onclick="cambiarCantidadBusqueda(1)">+</button>
          </div>
          <div class="price-select">
            <label>Precio:</label>
            <select id="busqueda-precio-tipo" onchange="renderListaProductos(State.productos)">
              <option value="1">P1</option>
              <option value="2">P2</option>
              <option value="3">P3</option>
              <option value="4">P4</option>
              <option value="5">P5</option>
              <option value="6">P6</option>
            </select>
          </div>
        </div>
      </div>
      <div class="modal-body no-padding">
        <table class="productos-table-large">
          <thead>
            <tr>
              <th class="col-code">Código</th>
              <th class="col-name">Producto</th>
              <th class="col-unit">Unidad</th>
              <th class="col-discount">Descuento</th>
              <th class="col-price">Precio</th>
            </tr>
          </thead>
          <tbody id="productos-tbody"></tbody>
        </table>
      </div>
    </div>
  </div>
  
  <!-- MODAL: COBRO -->
  <div id="modal-cobro" class="modal-overlay">
    <div class="modal modal-sm modal-cobro">
      <div class="cobro-header">
        <small>Total a Pagar</small>
        <h2 id="cobro-total">$0.00</h2>
        <span class="badge" id="cobro-tipo-badge">CONTADO</span>
      </div>
      <div class="cobro-body">
        <div class="cobro-metodos" id="cobro-metodos"></div>
        <div class="cobro-field">
          <label>Efectivo recibido</label>
          <input type="text" id="cobro-efectivo" placeholder="$0.00" oninput="calcularCambioCobro()">
        </div>
        <div class="cobro-denoms">
          <button onclick="addEfectivoCobro(50)">$50</button>
          <button onclick="addEfectivoCobro(100)">$100</button>
          <button onclick="addEfectivoCobro(200)">$200</button>
          <button onclick="addEfectivoCobro(500)">$500</button>
          <button onclick="addEfectivoCobro(1000)">$1000</button>
          <button onclick="setExactoCobro()">Exacto</button>
          <button onclick="limpiarEfectivoCobro()">Limpiar</button>
        </div>
        <div class="cobro-cambio" id="cobro-cambio-box">
          <span>Cambio</span>
          <strong id="cobro-cambio">$0.00</strong>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" onclick="cerrarModal('modal-cobro')">Cancelar</button>
        <button class="btn btn-success" id="btn-confirmar-venta" onclick="confirmarVenta()">
          <i class="fas fa-check"></i>
          <span>Confirmar Venta</span>
          <div class="spinner"></div>
        </button>
      </div>
    </div>
  </div>
  
  <!-- MODAL: ÉXITO -->
  <div id="modal-exito" class="modal-overlay">
    <div class="modal modal-sm modal-success">
      <div class="success-content">
        <div class="success-icon"><i class="fas fa-check"></i></div>
        <h2>¡Venta Exitosa!</h2>
        <div class="success-details">
          <p>Ticket: <strong id="exito-ticket">#0001</strong></p>
          <p>Total: <strong id="exito-total">$0.00</strong></p>
          <p>Cambio: <strong id="exito-cambio">$0.00</strong></p>
        </div>
        <div class="print-options">
          <label class="checkbox-print">
            <input type="checkbox" id="auto-print" checked>
            <span>Imprimir ticket automáticamente</span>
          </label>
        </div>
        <div class="success-actions">
          <button class="btn btn-outline" onclick="imprimirTicket()"><i class="fas fa-print"></i> Imprimir</button>
          <button class="btn btn-primary" onclick="cerrarExito()"><i class="fas fa-plus"></i> Nueva Venta</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- IFRAME OCULTO PARA IMPRESIÓN -->
  <iframe id="print-frame" style="display:none;"></iframe>
  
  <!-- MODAL: VENTAS EN ESPERA -->
  <div id="modal-espera" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <h3><i class="fas fa-clock"></i> Ventas en Espera</h3>
        <button class="btn-close" onclick="cerrarModal('modal-espera')"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body" id="espera-lista"></div>
    </div>
  </div>
  
<!-- MODAL: CRUD PRODUCTOS -->
<div id="modal-productos" class="modal-overlay">
  <div class="modal modal-xl">
    <div class="modal-header">
      <h3><i class="fas fa-box"></i> Productos</h3>
      <button class="btn-close" onclick="cerrarModal('modal-productos')"><i class="fas fa-times"></i></button>
    </div>
    <div class="modal-toolbar">
      <div class="search-field">
        <i class="fas fa-search"></i>
        <input type="text" placeholder="Buscar producto..." oninput="filtrarProductosCRUD(this.value)">
      </div>
      <button class="btn btn-primary" onclick="mostrarFormProducto()"><i class="fas fa-plus"></i> Nuevo</button>
    </div>
    <div class="modal-body no-padding">
      <table class="data-table">
   <thead>
  <tr>
    <th>Código</th>
    <th>Nombre</th>
    <th>Categoría</th>
    <th>Marca</th>
    <th>Precio</th>
    <th>Unidad</th>
    <th>Estado</th>
    <th></th>
  </tr>
</thead>
        <tbody id="tbody-productos"></tbody>
      </table>
    </div>
  </div>
</div>
  
 <!-- MODAL: FORM PRODUCTO -->
<div id="modal-form-producto" class="modal-overlay">
  <div class="modal modal-form-large">
    <div class="modal-header gradient">
      <h3 id="form-producto-titulo"><i class="fas fa-box"></i> Nuevo Producto</h3>
      <button class="btn-close light" onclick="cerrarModal('modal-form-producto')"><i class="fas fa-times"></i></button>
    </div>
    <form id="form-producto" onsubmit="event.preventDefault(); guardarProducto();">
      <input type="hidden" id="prod-id">
      <div class="modal-body-scroll">
        
        <!-- Info General -->
        <div class="form-section-title"><i class="fas fa-info-circle"></i> Información General</div>
        <div class="form-grid-2">
          <div class="form-field span-2">
            <label>Nombre del Producto *</label>
            <input type="text" id="prod-nombre" placeholder="Ej: Coca Cola 600ml" required>
          </div>
          <div class="form-field">
            <label>Nombre en POS</label>
            <input type="text" id="prod-pv-nombre" placeholder="Nombre corto para mostrar">
          </div>
          <div class="form-field">
            <label>Código de Barras</label>
            <input type="text" id="prod-codigo" placeholder="Escanea o escribe">
          </div>
          <div class="form-field">
            <label>Categoría</label>
            <select id="prod-categoria">
              <option value="">-- Sin categoría --</option>
            </select>
          </div>
          <div class="form-field">
            <label>Marca</label>
            <select id="prod-marca">
              <option value="">-- Sin marca --</option>
            </select>
          </div>
          <div class="form-field span-2">
            <label>Proveedor</label>
            <select id="prod-proveedor">
              <option value="">-- Sin proveedor --</option>
            </select>
          </div>
        </div>
        
        <!-- Unidades -->
        <div class="form-section-title"><i class="fas fa-boxes"></i> Unidades de Medida</div>
        <div class="form-grid-3">
          <div class="form-field">
            <label>Unidad de Compra</label>
            <select id="prod-unidad-compra">
              <option value="PZ">Pieza (PZ)</option>
              <option value="CJ">Caja (CJ)</option>
              <option value="PQ">Paquete (PQ)</option>
              <option value="BT">Bulto (BT)</option>
              <option value="KG">Kilogramo (KG)</option>
              <option value="LT">Litro (LT)</option>
            </select>
          </div>
          <div class="form-field">
            <label>Contenido por Unidad</label>
            <input type="number" id="prod-contenido" step="1" min="1" placeholder="Ej: 24">
          </div>
          <div class="form-field">
            <label>Unidad de Venta</label>
            <select id="prod-unidad">
              <option value="PZ">Pieza (PZ)</option>
              <option value="KG">Kilogramo (KG)</option>
              <option value="LT">Litro (LT)</option>
              <option value="MT">Metro (MT)</option>
              <option value="CJ">Caja (CJ)</option>
              <option value="PQ">Paquete (PQ)</option>
            </select>
          </div>
        </div>
        
        <!-- Venta por Peso -->
        <div class="form-section-title"><i class="fas fa-balance-scale"></i> Venta por Peso/Granel</div>
        <div class="form-grid-3">
          <div class="form-field">
            <label class="checkbox-inline">
              <input type="checkbox" id="prod-venta-peso" onchange="toggleVentaPeso()">
              <span>Venta por peso</span>
            </label>
          </div>
          <div class="form-field" id="grupo-unidad-base" style="display:none">
            <label>Unidad Base</label>
            <select id="prod-unidad-base">
              <option value="KG">Kilogramo (KG)</option>
              <option value="GR">Gramo (GR)</option>
              <option value="LT">Litro (LT)</option>
              <option value="ML">Mililitro (ML)</option>
              <option value="MT">Metro (MT)</option>
            </select>
          </div>
          <div class="form-field">
            <label class="checkbox-inline">
              <input type="checkbox" id="prod-permite-decimales">
              <span>Permite decimales</span>
            </label>
          </div>
        </div>
        
        <!-- Precios -->
        <div class="form-section-title"><i class="fas fa-dollar-sign"></i> Precios de Venta</div>
        <div class="form-grid-3">
          <div class="form-field">
            <label>Precio 1 (Principal)</label>
            <div class="input-with-prefix">
              <span>$</span>
              <input type="number" id="prod-precio1" step="0.01" placeholder="0.00">
            </div>
          </div>
          <div class="form-field">
            <label>Precio 2 (Mayoreo)</label>
            <div class="input-with-prefix">
              <span>$</span>
              <input type="number" id="prod-precio2" step="0.01" placeholder="0.00">
            </div>
          </div>
          <div class="form-field">
            <label>Precio 3 (Especial)</label>
            <div class="input-with-prefix">
              <span>$</span>
              <input type="number" id="prod-precio3" step="0.01" placeholder="0.00">
            </div>
          </div>
          <div class="form-field">
            <label>Precio 4</label>
            <div class="input-with-prefix">
              <span>$</span>
              <input type="number" id="prod-precio4" step="0.01" placeholder="0.00">
            </div>
          </div>
          <div class="form-field">
            <label>Precio 5</label>
            <div class="input-with-prefix">
              <span>$</span>
              <input type="number" id="prod-precio5" step="0.01" placeholder="0.00">
            </div>
          </div>
          <div class="form-field">
            <label>Precio 6</label>
            <div class="input-with-prefix">
              <span>$</span>
              <input type="number" id="prod-precio6" step="0.01" placeholder="0.00">
            </div>
          </div>
        </div>
        
        <!-- Descuentos -->
        <div class="form-section-title"><i class="fas fa-percentage"></i> Descuentos</div>
        <div class="form-grid-2">
          <div class="form-field">
            <label class="checkbox-inline">
              <input type="checkbox" id="prod-permite-descuento">
              <span>Permite aplicar descuento</span>
            </label>
          </div>
          <div class="form-field">
            <label>Descuento Máximo (%)</label>
            <div class="input-with-suffix">
              <input type="number" id="prod-descuento-max" step="1" min="0" max="100" placeholder="0">
              <span>%</span>
            </div>
          </div>
        </div>
        
        <!-- Ofertas -->
        <div class="form-section-title"><i class="fas fa-star"></i> Ofertas y Destacados</div>
        <div class="form-grid-2">
          <div class="form-field">
            <label class="checkbox-inline">
              <input type="checkbox" id="prod-destacado">
              <span>Producto destacado</span>
            </label>
          </div>
          <div class="form-field">
            <label>Orden Destacado</label>
            <input type="number" id="prod-orden-destacado" step="1" min="0" placeholder="0">
          </div>
          <div class="form-field">
            <label class="checkbox-inline">
              <input type="checkbox" id="prod-en-oferta" onchange="toggleOferta()">
              <span>En oferta</span>
            </label>
          </div>
          <div class="form-field" id="grupo-precio-oferta" style="display:none">
            <label>Precio de Oferta</label>
            <div class="input-with-prefix">
              <span>$</span>
              <input type="number" id="prod-precio-oferta" step="0.01" placeholder="0.00">
            </div>
          </div>
        </div>
        
        <!-- Puntos -->
        <div class="form-section-title"><i class="fas fa-coins"></i> Sistema de Puntos</div>
        <div class="form-grid-2">
          <div class="form-field">
            <label>Puntos que Otorga</label>
            <input type="number" id="prod-puntos" step="1" min="0" placeholder="0">
          </div>
          <div class="form-field">
            <label>Valor en Puntos (canje)</label>
            <input type="number" id="prod-valor-puntos" step="1" min="0" placeholder="0">
          </div>
        </div>
        
        <!-- Estado -->
        <div class="form-section-title"><i class="fas fa-toggle-on"></i> Estado</div>
        <div class="form-grid-2">
          <div class="form-field">
            <label class="checkbox-inline">
              <input type="checkbox" id="prod-activo" checked>
              <span>Producto activo</span>
            </label>
          </div>
        </div>
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline" onclick="cerrarModal('modal-form-producto')">
          <i class="fas fa-times"></i> Cancelar
        </button>
        <button type="submit" class="btn btn-primary" id="btn-guardar-producto">
          <i class="fas fa-save"></i> Guardar
        </button>
      </div>
    </form>
  </div>
</div>
  <!-- MODAL: CRUD CLIENTES -->
  <div id="modal-clientes" class="modal-overlay">
    <div class="modal modal-lg">
      <div class="modal-header">
        <h3><i class="fas fa-users"></i> Clientes</h3>
        <button class="btn-close" onclick="cerrarModal('modal-clientes')"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-toolbar">
        <div class="search-field">
          <i class="fas fa-search"></i>
          <input type="text" placeholder="Buscar cliente..." oninput="filtrarClientesCRUD(this.value)">
        </div>
        <button class="btn btn-primary" onclick="mostrarFormCliente()"><i class="fas fa-plus"></i> Nuevo</button>
      </div>
      <div class="modal-body">
        <table class="data-table">
          <thead>
            <tr><th>Nombre</th><th>Teléfono</th><th>Precio</th><th>Crédito</th><th>Límite</th><th></th></tr>
          </thead>
          <tbody id="tbody-clientes"></tbody>
        </table>
      </div>
    </div>
  </div>
  
  <!-- MODAL: FORM CLIENTE -->
  <div id="modal-form-cliente" class="modal-overlay">
    <div class="modal modal-form-medium">
      <div class="modal-header gradient">
        <h3 id="form-cliente-titulo"><i class="fas fa-user-plus"></i> Nuevo Cliente</h3>
        <button class="btn-close light" onclick="cerrarModal('modal-form-cliente')"><i class="fas fa-times"></i></button>
      </div>
      <form id="form-cliente" onsubmit="event.preventDefault(); guardarCliente();">
        <input type="hidden" id="cli-id">
        <div class="modal-body-scroll">
          <!-- Datos del Cliente -->
          <div class="form-section-title"><i class="fas fa-user"></i> Datos del Cliente</div>
          <div class="form-grid-2">
            <div class="form-field span-2">
              <label>Nombre Completo *</label>
              <input type="text" id="cli-nombre" placeholder="Nombre del cliente" required>
            </div>
            <div class="form-field">
              <label>Teléfono</label>
              <input type="tel" id="cli-telefono" placeholder="10 dígitos">
            </div>
            <div class="form-field">
              <label>Email</label>
              <input type="email" id="cli-email" placeholder="correo@ejemplo.com">
            </div>
            <div class="form-field span-2">
              <label>Dirección</label>
              <input type="text" id="cli-direccion" placeholder="Calle, número, colonia">
            </div>
          </div>
          
          <!-- Tipo de Precio -->
          <div class="form-section-title"><i class="fas fa-tags"></i> Tipo de Precio Asignado</div>
          <div class="price-selector">
            <label class="price-radio">
              <input type="radio" name="cli-precio" value="1" checked>
              <span>P1<small>Principal</small></span>
            </label>
            <label class="price-radio">
              <input type="radio" name="cli-precio" value="2">
              <span>P2<small>Mayoreo</small></span>
            </label>
            <label class="price-radio">
              <input type="radio" name="cli-precio" value="3">
              <span>P3<small>Especial</small></span>
            </label>
            <label class="price-radio">
              <input type="radio" name="cli-precio" value="4">
              <span>P4</span>
            </label>
            <label class="price-radio">
              <input type="radio" name="cli-precio" value="5">
              <span>P5</span>
            </label>
            <label class="price-radio">
              <input type="radio" name="cli-precio" value="6">
              <span>P6</span>
            </label>
          </div>
          
          <!-- Crédito -->
          <div class="form-section-title"><i class="fas fa-credit-card"></i> Crédito</div>
          <div class="form-grid-2">
            <div class="form-field">
              <label class="checkbox-inline">
                <input type="checkbox" id="cli-credito" onchange="toggleCredito()">
                <span>Permitir ventas a crédito</span>
              </label>
            </div>
            <div class="form-field" id="grupo-limite" style="display:none">
              <label>Límite de Crédito</label>
              <div class="input-with-prefix">
                <span>$</span>
                <input type="number" id="cli-limite" step="0.01" placeholder="0.00">
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline" onclick="cerrarModal('modal-form-cliente')">
            <i class="fas fa-times"></i> Cancelar
          </button>
          <button type="submit" class="btn btn-primary" id="btn-guardar-cliente">
            <i class="fas fa-save"></i> Guardar Cliente
          </button>
        </div>
      </form>
    </div>
  </div>
  
  <!-- MODAL: SELECCIONAR CLIENTE -->
  <div id="modal-seleccionar-cliente" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <h3><i class="fas fa-user-check"></i> Seleccionar Cliente</h3>
        <button class="btn-close" onclick="cerrarModal('modal-seleccionar-cliente')"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-toolbar">
        <div class="search-field">
          <i class="fas fa-search"></i>
          <input type="text" id="buscar-cliente-sel" placeholder="Buscar cliente..." oninput="filtrarClientesSeleccion(this.value)">
        </div>
        <button class="btn btn-primary" onclick="cerrarModal('modal-seleccionar-cliente'); mostrarFormCliente();"><i class="fas fa-plus"></i> Nuevo</button>
      </div>
      <div class="modal-body">
        <div class="client-list">
          <div class="client-item" onclick="seleccionarCliente(null)">
            <div class="avatar neutral"><i class="fas fa-user-slash"></i></div>
            <div class="info">
              <strong>Público General</strong>
              <small>Sin cliente asignado</small>
            </div>
          </div>
          <div id="lista-clientes-sel"></div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- MODAL: INFO USUARIO -->
  <div id="modal-usuario" class="modal-overlay">
    <div class="modal modal-sm">
      <div class="modal-header">
        <h3><i class="fas fa-user-circle"></i> Mi Cuenta</h3>
        <button class="btn-close" onclick="cerrarModal('modal-usuario')"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body">
        <div class="user-profile">
          <div class="avatar large" id="usuario-avatar-grande">US</div>
          <h3 id="usuario-nombre-completo">Usuario</h3>
          <p id="usuario-email-info">email@ejemplo.com</p>
        </div>
        <div class="user-details">
          <div class="detail"><i class="fas fa-building"></i><span id="usuario-empresa">Empresa</span></div>
          <div class="detail"><i class="fas fa-store"></i><span id="usuario-sucursal-info">Sucursal</span></div>
          <div class="detail"><i class="fas fa-id-badge"></i><span id="usuario-rol">Rol</span></div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-danger btn-block" onclick="cerrarSesion()">
          <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
        </button>
      </div>
    </div>
  </div>
  
  <!-- MODAL: AUTORIZACIÓN ADMIN -->
  <div id="modal-admin-auth" class="modal-overlay">
    <div class="modal modal-sm modal-auth">
      <div class="modal-header danger">
        <h3><i class="fas fa-shield-alt"></i> Autorización Requerida</h3>
        <button class="btn-close light" onclick="cerrarModal('modal-admin-auth')"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body">
        <div class="auth-icon">
          <i class="fas fa-lock"></i>
        </div>
        <p class="auth-message" id="auth-message">Esta acción requiere autorización de un administrador</p>
        <div class="auth-action" id="auth-action-desc"></div>
        <div class="field">
          <label><i class="fas fa-envelope"></i> Email del Administrador</label>
          <input type="email" id="admin-email" placeholder="admin@empresa.com">
        </div>
        <div class="field">
          <label><i class="fas fa-key"></i> Contraseña</label>
          <input type="password" id="admin-password" placeholder="••••••••">
        </div>
        <div id="auth-error" class="error-msg"></div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" onclick="cerrarModal('modal-admin-auth')">Cancelar</button>
        <button class="btn btn-danger" id="btn-auth-confirm" onclick="confirmarAutorizacionAdmin()">
          <i class="fas fa-check"></i>
          <span>Autorizar</span>
          <div class="spinner"></div>
        </button>
      </div>
    </div>
  </div>
  
  <!-- MODAL: CAMBIAR PRECIO EN LÍNEA -->
  <div id="modal-cambiar-precio" class="modal-overlay">
    <div class="modal modal-sm">
      <div class="modal-header">
        <h3><i class="fas fa-dollar-sign"></i> Cambiar Precio</h3>
        <button class="btn-close" onclick="cerrarModal('modal-cambiar-precio')"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="cambio-precio-index">
        <div class="producto-info-cambio">
          <strong id="cambio-precio-producto">Producto</strong>
          <small>Precio actual: <span id="cambio-precio-actual">$0.00</span></small>
        </div>
        <div class="field">
          <label>Nuevo Precio</label>
          <div class="input-money large">
            <span>$</span>
            <input type="number" id="nuevo-precio" step="1" placeholder="0">
          </div>
        </div>
        <div class="precios-rapidos">
          <span>Precios disponibles:</span>
          <div class="precios-btns" id="precios-disponibles"></div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" onclick="cerrarModal('modal-cambiar-precio')">Cancelar</button>
        <button class="btn btn-primary" onclick="aplicarNuevoPrecio()">
          <i class="fas fa-check"></i> Aplicar
        </button>
      </div>
    </div>
  </div>
  
  <!-- MODAL: CANTIDAD PESO -->
  <div id="modal-cantidad-peso" class="modal-overlay">
    <div class="modal modal-sm modal-peso">
      <div class="modal-header gradient">
        <h3><i class="fas fa-balance-scale"></i> Cantidad</h3>
        <button class="btn-close light" onclick="cerrarModal('modal-cantidad-peso')"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body">
        <div class="peso-producto-info">
          <strong id="peso-producto-nombre">Producto</strong>
          <span id="peso-producto-precio">$0.00 / KG</span>
        </div>
        
        <div class="peso-input-group">
          <div class="peso-input">
            <input type="number" id="peso-cantidad" step="0.001" min="0" placeholder="0.000" oninput="calcularSubtotalPeso()">
            <span class="peso-unidad" id="peso-unidad">KG</span>
          </div>
          <div class="peso-subtotal">
            <small>Subtotal</small>
            <strong id="peso-subtotal">$0.00</strong>
          </div>
        </div>
        
        <div class="peso-btns-rapidos" id="peso-btns-rapidos"></div>
        
        <button class="btn-limpiar-peso" onclick="limpiarPesoCantidad()">
          <i class="fas fa-eraser"></i> Limpiar
        </button>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" onclick="cerrarModal('modal-cantidad-peso')">Cancelar</button>
        <button class="btn btn-success" onclick="confirmarCantidadPeso()">
          <i class="fas fa-plus"></i> Agregar
        </button>
      </div>
    </div>
  </div>
  
  <!-- MODAL: ABRIR TURNO -->
  <div id="modal-abrir-turno" class="modal-overlay">
    <div class="modal modal-sm">
      <div class="modal-header gradient">
        <h3><i class="fas fa-play-circle"></i> Abrir Turno</h3>
        <button class="btn-close light" onclick="cerrarModal('modal-abrir-turno')"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body">
        <div class="turno-info-box">
          <i class="fas fa-info-circle"></i>
          <p>Ingresa el efectivo con el que inicias tu turno</p>
        </div>
        
        <div class="form-group">
          <label>Saldo Inicial en Caja</label>
          <div class="input-icon">
            <i class="fas fa-dollar-sign"></i>
            <input type="number" id="turno-saldo-inicial" placeholder="0.00" step="0.01" min="0">
          </div>
        </div>
        
        <div class="turno-error" id="turno-error"></div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" onclick="cerrarModal('modal-abrir-turno')">Cancelar</button>
        <button class="btn btn-success" id="btn-confirmar-turno" onclick="Turno.abrir()">
          <i class="fas fa-play"></i> Abrir Turno
        </button>
      </div>
    </div>
  </div>

  <!-- MODAL: MOVIMIENTO DE CAJA -->
  <div id="modal-movimiento-caja" class="modal-overlay">
    <div class="modal modal-sm">
      <div class="modal-header gradient">
        <h3><i id="modal-movimiento-icon" class="fas fa-arrow-up"></i> <span id="modal-movimiento-titulo">Retiro de Caja</span></h3>
        <button class="btn-close light" onclick="cerrarModal('modal-movimiento-caja')"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="mov-tipo" value="Egreso">
        
        <div class="form-group">
          <label>Monto</label>
          <div class="input-icon">
            <i class="fas fa-dollar-sign"></i>
            <input type="number" id="mov-monto" placeholder="0.00" step="0.01" min="0.01">
          </div>
        </div>
        
        <div class="form-group">
          <label>Concepto</label>
          <input type="text" id="mov-concepto" placeholder="Ej: Pago a proveedor, Compra de insumos...">
        </div>
        
        <div class="form-group">
          <label>Categoría (opcional)</label>
          <select id="mov-categoria">
            <option value="">-- Seleccionar --</option>
            <option value="Compras">Compras</option>
            <option value="Gastos operativos">Gastos operativos</option>
            <option value="Pago proveedores">Pago proveedores</option>
            <option value="Servicios">Servicios</option>
            <option value="Nómina">Nómina</option>
            <option value="Depósito banco">Depósito banco</option>
            <option value="Cambio">Cambio</option>
            <option value="Otro">Otro</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>Observaciones (opcional)</label>
          <textarea id="mov-observaciones" rows="2" placeholder="Notas adicionales..."></textarea>
        </div>
        
        <div class="turno-error" id="mov-error"></div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" onclick="cerrarModal('modal-movimiento-caja')">Cancelar</button>
        <button class="btn btn-primary" id="btn-confirmar-movimiento" onclick="Turno.registrarMovimiento()">
          <i class="fas fa-save"></i> Guardar
        </button>
      </div>
    </div>
  </div>

<!-- MODAL: CERRAR TURNO / CORTE DE CAJA -->
<div id="modal-cerrar-turno" class="modal-overlay">
  <div class="modal modal-lg">
    <div class="modal-header gradient">
      <h3><i class="fas fa-cash-register"></i> Corte de Caja</h3>
      <button class="btn-close light" onclick="cerrarModal('modal-cerrar-turno')"><i class="fas fa-times"></i></button>
    </div>
    
    <!-- TABS -->
    <div class="corte-tabs">
      <button class="corte-tab active" onclick="cambiarTabCorte(0)">
        <i class="fas fa-coins"></i> Efectivo
      </button>
      <button class="corte-tab" onclick="cambiarTabCorte(1)">
        <i class="fas fa-credit-card"></i> Otros Métodos
      </button>
      <button class="corte-tab" onclick="cambiarTabCorte(2)">
        <i class="fas fa-clipboard-check"></i> Resumen
      </button>
    </div>
    
    <div class="modal-body corte-body">
      
      <!-- TAB 1: EFECTIVO -->
      <div class="corte-tab-content active" id="tab-efectivo">
        <div class="corte-seccion">
          <h4><i class="fas fa-money-bill-wave"></i> Conteo de Efectivo</h4>
          
          <div class="conteo-grid">
            <!-- Billetes -->
            <div class="conteo-grupo">
              <span class="conteo-titulo">Billetes</span>
              <div class="conteo-row">
                <label>$1000</label>
                <input type="number" id="conteo-1000" value="0" min="0" onchange="calcularConteoEfectivo()">
                <span class="conteo-subtotal" id="sub-1000">$0</span>
              </div>
              <div class="conteo-row">
                <label>$500</label>
                <input type="number" id="conteo-500" value="0" min="0" onchange="calcularConteoEfectivo()">
                <span class="conteo-subtotal" id="sub-500">$0</span>
              </div>
              <div class="conteo-row">
                <label>$200</label>
                <input type="number" id="conteo-200" value="0" min="0" onchange="calcularConteoEfectivo()">
                <span class="conteo-subtotal" id="sub-200">$0</span>
              </div>
              <div class="conteo-row">
                <label>$100</label>
                <input type="number" id="conteo-100" value="0" min="0" onchange="calcularConteoEfectivo()">
                <span class="conteo-subtotal" id="sub-100">$0</span>
              </div>
              <div class="conteo-row">
                <label>$50</label>
                <input type="number" id="conteo-50" value="0" min="0" onchange="calcularConteoEfectivo()">
                <span class="conteo-subtotal" id="sub-50">$0</span>
              </div>
              <div class="conteo-row">
                <label>$20</label>
                <input type="number" id="conteo-20" value="0" min="0" onchange="calcularConteoEfectivo()">
                <span class="conteo-subtotal" id="sub-20">$0</span>
              </div>
            </div>
            
            <!-- Monedas -->
            <div class="conteo-grupo">
              <span class="conteo-titulo">Monedas</span>
              <div class="conteo-row">
                <label>$20</label>
                <input type="number" id="conteo-m20" value="0" min="0" onchange="calcularConteoEfectivo()">
                <span class="conteo-subtotal" id="sub-m20">$0</span>
              </div>
              <div class="conteo-row">
                <label>$10</label>
                <input type="number" id="conteo-10" value="0" min="0" onchange="calcularConteoEfectivo()">
                <span class="conteo-subtotal" id="sub-10">$0</span>
              </div>
              <div class="conteo-row">
                <label>$5</label>
                <input type="number" id="conteo-5" value="0" min="0" onchange="calcularConteoEfectivo()">
                <span class="conteo-subtotal" id="sub-5">$0</span>
              </div>
              <div class="conteo-row">
                <label>$2</label>
                <input type="number" id="conteo-2" value="0" min="0" onchange="calcularConteoEfectivo()">
                <span class="conteo-subtotal" id="sub-2">$0</span>
              </div>
              <div class="conteo-row">
                <label>$1</label>
                <input type="number" id="conteo-1" value="0" min="0" onchange="calcularConteoEfectivo()">
                <span class="conteo-subtotal" id="sub-1">$0</span>
              </div>
              <div class="conteo-row">
                <label>$0.50</label>
                <input type="number" id="conteo-050" value="0" min="0" onchange="calcularConteoEfectivo()">
                <span class="conteo-subtotal" id="sub-050">$0</span>
              </div>
            </div>
          </div>
          
          <div class="conteo-total-row">
            <span>Total Efectivo Contado:</span>
            <strong id="total-efectivo-contado">$0.00</strong>
          </div>
        </div>
      </div>
      
      <!-- TAB 2: OTROS MÉTODOS -->
      <div class="corte-tab-content" id="tab-otros">
        <div class="corte-seccion">
          <h4><i class="fas fa-credit-card"></i> Otros Métodos de Pago</h4>
          <p class="corte-hint">Ingresa los montos recibidos por cada método</p>
          
          <div class="metodos-conteo">
            <div class="metodo-row">
              <label><i class="fas fa-credit-card"></i> Tarjeta</label>
              <div class="input-money-sm">
                <span>$</span>
                <input type="number" id="corte-tarjeta" value="0" min="0" step="0.01" onchange="calcularTotalCorte()">
              </div>
            </div>
            <div class="metodo-row">
              <label><i class="fas fa-mobile-alt"></i> Transferencia</label>
              <div class="input-money-sm">
                <span>$</span>
                <input type="number" id="corte-transferencia" value="0" min="0" step="0.01" onchange="calcularTotalCorte()">
              </div>
            </div>
            <div class="metodo-row">
              <label><i class="fas fa-wallet"></i> Otro</label>
              <div class="input-money-sm">
                <span>$</span>
                <input type="number" id="corte-otro" value="0" min="0" step="0.01" onchange="calcularTotalCorte()">
              </div>
            </div>
          </div>
          
          <div class="conteo-total-row" style="margin-top:20px; background: var(--secondary);">
            <span>Total Otros Métodos:</span>
            <strong id="total-otros-metodos">$0.00</strong>
          </div>
        </div>
      </div>
      
      <!-- TAB 3: RESUMEN -->
      <div class="corte-tab-content" id="tab-resumen">
        <div class="corte-seccion">
          <h4><i class="fas fa-chart-bar"></i> Resumen del Turno</h4>
          
          <div class="resumen-turno-grid">
            <div class="resumen-item">
              <span class="resumen-label">Saldo Inicial</span>
              <span class="resumen-value" id="resumen-saldo-inicial">$0.00</span>
            </div>
            <div class="resumen-item">
              <span class="resumen-label">Ventas Totales</span>
              <span class="resumen-value success" id="resumen-ventas">$0.00</span>
            </div>
            <div class="resumen-item">
              <span class="resumen-label">Ingresos</span>
              <span class="resumen-value success" id="resumen-ingresos">$0.00</span>
            </div>
            <div class="resumen-item">
              <span class="resumen-label">Egresos</span>
              <span class="resumen-value danger" id="resumen-egresos">$0.00</span>
            </div>
          </div>
          
          <div class="resumen-esperado">
            <div class="esperado-row">
              <span>Efectivo Esperado:</span>
              <strong id="resumen-efectivo-esperado">$0.00</strong>
            </div>
            <div class="esperado-row">
              <span>Efectivo Contado:</span>
              <strong id="resumen-efectivo-contado">$0.00</strong>
            </div>
            <div class="esperado-row diferencia" id="row-diferencia">
              <span>Diferencia:</span>
              <strong id="resumen-diferencia">$0.00</strong>
            </div>
          </div>
          
          <div class="total-general">
            <div class="total-general-row">
              <span>TOTAL DECLARADO:</span>
              <strong id="total-declarado">$0.00</strong>
            </div>
          </div>
          
          <div class="form-group" style="margin-top:16px;">
            <label>Observaciones (opcional)</label>
            <textarea id="corte-observaciones" rows="2" placeholder="Notas del corte..."></textarea>
          </div>
        </div>
      </div>
      
    </div>
    
    <div class="modal-footer">
      <button class="btn btn-outline" onclick="cerrarModal('modal-cerrar-turno')">Cancelar</button>
      <button class="btn btn-outline" id="btn-tab-anterior" onclick="tabAnteriorCorte()" style="display:none;">
        <i class="fas fa-arrow-left"></i> Anterior
      </button>
      <button class="btn btn-primary" id="btn-tab-siguiente" onclick="tabSiguienteCorte()">
        Siguiente <i class="fas fa-arrow-right"></i>
      </button>
      <button class="btn btn-success" id="btn-calcular-corte" onclick="procesarCorte()" style="display:none;">
        <i class="fas fa-calculator"></i> Cerrar Turno
      </button>
    </div>
  </div>
</div>
  
  <!-- MODAL: CONFIRMACIÓN PERSONALIZADA -->
  <div id="modal-confirm" class="modal-overlay">
    <div class="modal modal-confirm">
      <div class="confirm-icon" id="confirm-icon">
        <i class="fas fa-question-circle"></i>
      </div>
      <h3 id="confirm-titulo">¿Estás seguro?</h3>
      <p id="confirm-mensaje">Esta acción no se puede deshacer.</p>
      <div class="confirm-buttons">
        <button class="btn btn-outline" onclick="cerrarConfirm(false)">
          <i class="fas fa-times"></i> Cancelar
        </button>
        <button class="btn btn-danger" id="btn-confirm-ok" onclick="cerrarConfirm(true)">
          <i class="fas fa-check"></i> Confirmar
        </button>
      </div>
    </div>
  </div>
  
  <!-- MODAL: GUARDADO EXITOSO -->
  <div id="modal-guardado" class="modal-overlay">
    <div class="modal modal-guardado">
      <div class="guardado-animation">
        <div class="checkmark-circle">
          <div class="checkmark"></div>
        </div>
      </div>
      <h3 id="guardado-titulo">¡Guardado!</h3>
      <p id="guardado-mensaje">El registro se guardó correctamente</p>
    </div>
  </div>
  
  <!-- TOAST -->
  <div id="toast" class="toast"></div>
  
  <!-- SCRIPTS -->
  <script src="config.js"></script>
  <script src="api.js"></script>
  <script src="app.js"></script>
</body>
</html>
